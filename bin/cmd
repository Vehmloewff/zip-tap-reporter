#!/usr/bin/env node

const createReporter = require('../dist/build.cjs');
const { spawn } = require('child_process');

const reporter = createReporter();

const args = process.argv;

args.shift();
args.shift();

if (!args.length) process.stdin.on('data', reporter.log);
else {
	const command = spawn(args.shift(), args);

	command.stdout.on('data', data => {
		reporter.log(data);
	});
	command.stderr.on('data', data => {
		reporter.log(data);
	});
	command.on('close', code => {
		if (code) reporter.bail();

		process.exit(code);
	});
}
